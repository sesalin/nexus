{"version":3,"file":"index.js","sources":["../../../../../src/Cards/CameraCard/players/index.tsx"],"sourcesContent":["import { useEffect, useRef, useCallback, useImperativeHandle, forwardRef } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { localize } from \"@hakit/core\";\n\nexport type VideoState = \"canplay\" | \"canplaythrough\" | \"waiting\" | \"stalled\" | \"loadeddata\" | \"play\" | \"playing\" | \"pause\";\n\nexport interface VideoPlayerProps extends Omit<React.HTMLProps<HTMLVideoElement>, \"as\"> {\n  src?: string;\n  type?: string;\n  onVideoStateChange?: (state: VideoState) => void;\n}\n\nconst Video = styled.video`\n  display: block;\n  width: 100%;\n`;\n\nexport const VideoPlayer = forwardRef<HTMLVideoElement, VideoPlayerProps>(({ src, type, onVideoStateChange, ...rest }, ref) => {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n\n  useImperativeHandle(ref, () => videoRef.current!);\n\n  const notifyStateChange = useCallback(\n    (state: VideoState) => {\n      if (onVideoStateChange) {\n        onVideoStateChange(state);\n      }\n    },\n    [onVideoStateChange],\n  );\n\n  useEffect(() => {\n    const videoElement = videoRef.current;\n\n    const handleCanPlay = () => {\n      notifyStateChange(\"canplay\");\n    };\n\n    const handleCanPlayThrough = () => {\n      notifyStateChange(\"canplaythrough\");\n    };\n\n    const handleWaiting = () => {\n      notifyStateChange(\"waiting\");\n    };\n\n    const handleStalled = () => {\n      notifyStateChange(\"stalled\");\n    };\n\n    const handleLoadedData = () => {\n      notifyStateChange(\"loadeddata\");\n    };\n    const handlePlay = () => {\n      notifyStateChange(\"play\");\n    };\n    const handlePlaying = () => {\n      notifyStateChange(\"playing\");\n    };\n    const handlePause = () => {\n      notifyStateChange(\"pause\");\n    };\n\n    if (videoElement) {\n      videoElement.addEventListener(\"canplay\", handleCanPlay);\n      videoElement.addEventListener(\"canplaythrough\", handleCanPlayThrough);\n      videoElement.addEventListener(\"waiting\", handleWaiting);\n      videoElement.addEventListener(\"stalled\", handleStalled);\n      videoElement.addEventListener(\"loadeddata\", handleLoadedData);\n      videoElement.addEventListener(\"playing\", handlePlaying);\n      videoElement.addEventListener(\"play\", handlePlay);\n      videoElement.addEventListener(\"pause\", handlePause);\n    }\n\n    return () => {\n      if (videoElement) {\n        videoElement.removeEventListener(\"canplay\", handleCanPlay);\n        videoElement.removeEventListener(\"canplaythrough\", handleCanPlayThrough);\n        videoElement.removeEventListener(\"waiting\", handleWaiting);\n        videoElement.removeEventListener(\"stalled\", handleStalled);\n        videoElement.removeEventListener(\"loadeddata\", handleLoadedData);\n        videoElement.removeEventListener(\"playing\", handlePlaying);\n        videoElement.removeEventListener(\"play\", handlePlay);\n        videoElement.removeEventListener(\"pause\", handlePause);\n      }\n    };\n  }, [notifyStateChange]);\n\n  return (\n    <Video ref={videoRef} {...rest}>\n      <source src={src} type={type} />\n      {localize(\"fields.format.description\")}\n    </Video>\n  );\n});\n\nVideoPlayer.displayName = \"VideoPlayer\";\n"],"names":["Video","_styled","process","env","NODE_ENV","target","label","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","VideoPlayer","forwardRef","src","type","onVideoStateChange","rest","ref","videoRef","useRef","useImperativeHandle","current","notifyStateChange","useCallback","state","useEffect","videoElement","handleCanPlay","handleCanPlayThrough","handleWaiting","handleStalled","handleLoadedData","handlePlay","handlePlaying","handlePause","addEventListener","removeEventListener","jsxs","jsx","localize","displayName"],"mappings":";;;;;;;AAYA,MAAMA,IAAKC,gBAAAA,EAAA,SAAAC,QAAAC,IAAAC,aAAA,eAAA;AAAA,EAAAC,QAAA;AAAA,IAAA;AAAA,EAAAA,QAAA;AAAA,EAAAC,OAAA;AAAA,CAAA,EAAAJ,QAAAC,IAAAC,aAAA,eAAA;AAAA,EAAAG,MAAA;AAAA,EAAAC,QAAA;AAAA,IAAA;AAAA,EAAAD,MAAA;AAAA,EAAAC,QAAA;AAAA,EAAAC,UAAAC;AAAA,CAAA,GAKEC,IAAcC,EAA+C,CAAC;AAAA,EAAEC,KAAAA;AAAAA,EAAKC,MAAAA;AAAAA,EAAMC,oBAAAA;AAAAA,EAAoB,GAAGC;AAAK,GAAGC,MAAQ;AAC7H,QAAMC,IAAWC,EAAgC,IAAI;AAErDC,EAAAA,EAAoBH,GAAK,MAAMC,EAASG,OAAQ;AAEhD,QAAMC,IAAoBC,EACxB,CAACC,MAAsB;AACrB,IAAIT,KACFA,EAAmBS,CAAK;AAAA,EAE5B,GACA,CAACT,CAAkB,CACrB;AAEAU,SAAAA,EAAU,MAAM;AACd,UAAMC,IAAeR,EAASG,SAExBM,IAAgBA,MAAM;AAC1BL,MAAAA,EAAkB,SAAS;AAAA,IAC7B,GAEMM,IAAuBA,MAAM;AACjCN,MAAAA,EAAkB,gBAAgB;AAAA,IACpC,GAEMO,IAAgBA,MAAM;AAC1BP,MAAAA,EAAkB,SAAS;AAAA,IAC7B,GAEMQ,IAAgBA,MAAM;AAC1BR,MAAAA,EAAkB,SAAS;AAAA,IAC7B,GAEMS,IAAmBA,MAAM;AAC7BT,MAAAA,EAAkB,YAAY;AAAA,IAChC,GACMU,IAAaA,MAAM;AACvBV,MAAAA,EAAkB,MAAM;AAAA,IAC1B,GACMW,IAAgBA,MAAM;AAC1BX,MAAAA,EAAkB,SAAS;AAAA,IAC7B,GACMY,IAAcA,MAAM;AACxBZ,MAAAA,EAAkB,OAAO;AAAA,IAC3B;AAEA,WAAII,MACFA,EAAaS,iBAAiB,WAAWR,CAAa,GACtDD,EAAaS,iBAAiB,kBAAkBP,CAAoB,GACpEF,EAAaS,iBAAiB,WAAWN,CAAa,GACtDH,EAAaS,iBAAiB,WAAWL,CAAa,GACtDJ,EAAaS,iBAAiB,cAAcJ,CAAgB,GAC5DL,EAAaS,iBAAiB,WAAWF,CAAa,GACtDP,EAAaS,iBAAiB,QAAQH,CAAU,GAChDN,EAAaS,iBAAiB,SAASD,CAAW,IAG7C,MAAM;AACX,MAAIR,MACFA,EAAaU,oBAAoB,WAAWT,CAAa,GACzDD,EAAaU,oBAAoB,kBAAkBR,CAAoB,GACvEF,EAAaU,oBAAoB,WAAWP,CAAa,GACzDH,EAAaU,oBAAoB,WAAWN,CAAa,GACzDJ,EAAaU,oBAAoB,cAAcL,CAAgB,GAC/DL,EAAaU,oBAAoB,WAAWH,CAAa,GACzDP,EAAaU,oBAAoB,QAAQJ,CAAU,GACnDN,EAAaU,oBAAoB,SAASF,CAAW;AAAA,IAEzD;AAAA,EACF,GAAG,CAACZ,CAAiB,CAAC,GAGpB,gBAAAe,EAACrC,GAAA,EAAM,KAAKkB,GAAU,GAAIF,GACxB,UAAA;AAAA,IAAA,gBAAAsB,EAAC,UAAA,EAAO,KAAAzB,GAAU,MAAAC,EAAA,CAAW;AAAA,IAC5ByB,EAAS,2BAA2B;AAAA,EAAA,GACvC;AAEJ,CAAC;AAED5B,EAAY6B,cAAc;"}