{"version":3,"file":"index.js","sources":["../../../../src/Shared/AutoHeight/index.tsx"],"sourcesContent":["import React, { useRef, useState, useLayoutEffect } from \"react\";\n\ntype AutoHeightProps = {\n  isOpen: boolean;\n  children: React.ReactNode;\n  duration?: number;\n  className?: string;\n  style?: React.CSSProperties;\n  onCollapseComplete?: () => void;\n};\n\nexport const AutoHeight = ({ isOpen, children, duration = 300, className, style, onCollapseComplete }: AutoHeightProps) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [renderChildren, setRenderChildren] = useState(isOpen);\n  const [shouldAnimate, setShouldAnimate] = useState(true);\n  const hasMountedRef = useRef(false);\n  const animationTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const rafRef = useRef<number | null>(null);\n  const isAnimatingRef = useRef(false);\n\n  // Ensure children are present before measuring during expand\n  useLayoutEffect(() => {\n    const el = containerRef.current;\n    if (!el) return;\n\n    // Cleanup any ongoing animations\n    if (animationTimeoutRef.current) {\n      clearTimeout(animationTimeoutRef.current);\n      animationTimeoutRef.current = null;\n    }\n    if (rafRef.current) {\n      cancelAnimationFrame(rafRef.current);\n      rafRef.current = null;\n    }\n\n    // On first render only\n    if (!hasMountedRef.current) {\n      hasMountedRef.current = true;\n      if (isOpen) {\n        // Start open: skip animation\n        setRenderChildren(true);\n        setShouldAnimate(false);\n        el.style.height = \"auto\";\n        isAnimatingRef.current = false;\n      } else {\n        // Start collapsed: do nothing, wait for open to trigger animation\n        setRenderChildren(false);\n        isAnimatingRef.current = false;\n      }\n      return;\n    }\n\n    // Prevent redundant animations\n    if (isAnimatingRef.current) return;\n\n    if (isOpen) {\n      if (renderChildren && el.style.height === \"auto\") {\n        // Already open and rendered, no need to animate\n        return;\n      }\n\n      isAnimatingRef.current = true;\n      setRenderChildren(true);\n      el.style.height = \"0px\";\n\n      rafRef.current = requestAnimationFrame(() => {\n        const scrollHeight = el.scrollHeight;\n        setShouldAnimate(true);\n        el.style.transition = `height ${duration}ms ease`;\n        el.style.height = `${scrollHeight}px`;\n\n        animationTimeoutRef.current = setTimeout(() => {\n          el.style.transition = \"\";\n          el.style.height = \"auto\";\n          isAnimatingRef.current = false;\n          animationTimeoutRef.current = null;\n        }, duration);\n      });\n    } else {\n      if (!renderChildren) {\n        // Already collapsed, no need to animate\n        return;\n      }\n\n      isAnimatingRef.current = true;\n      const currentHeight = el.scrollHeight;\n      el.style.height = `${currentHeight}px`;\n\n      rafRef.current = requestAnimationFrame(() => {\n        setShouldAnimate(true);\n        el.style.transition = `height ${duration}ms ease`;\n        el.style.height = \"0px\";\n\n        animationTimeoutRef.current = setTimeout(() => {\n          setRenderChildren(false);\n          isAnimatingRef.current = false;\n          animationTimeoutRef.current = null;\n          if (onCollapseComplete) onCollapseComplete();\n        }, duration);\n      });\n    }\n\n    // Cleanup function\n    return () => {\n      if (animationTimeoutRef.current) {\n        clearTimeout(animationTimeoutRef.current);\n        animationTimeoutRef.current = null;\n      }\n      if (rafRef.current) {\n        cancelAnimationFrame(rafRef.current);\n        rafRef.current = null;\n      }\n      isAnimatingRef.current = false;\n    };\n  }, [isOpen, duration, onCollapseComplete, renderChildren]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={className}\n      style={{\n        overflow: \"hidden\",\n        height: isOpen && !shouldAnimate ? \"auto\" : undefined,\n        ...style,\n      }}\n    >\n      {renderChildren ? children : null}\n    </div>\n  );\n};\n"],"names":["AutoHeight","isOpen","children","duration","className","style","onCollapseComplete","containerRef","useRef","renderChildren","setRenderChildren","useState","shouldAnimate","setShouldAnimate","hasMountedRef","animationTimeoutRef","rafRef","isAnimatingRef","useLayoutEffect","el","current","clearTimeout","cancelAnimationFrame","height","requestAnimationFrame","scrollHeight","transition","setTimeout","currentHeight","jsx","overflow","undefined"],"mappings":"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"}