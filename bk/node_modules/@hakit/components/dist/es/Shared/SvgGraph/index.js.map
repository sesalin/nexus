{"version":3,"file":"index.js","sources":["../../../../src/Shared/SvgGraph/index.tsx"],"sourcesContent":["import { useState, useEffect, useRef, ComponentPropsWithoutRef } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { css } from \"@emotion/react\";\nimport { SVG_HEIGHT, SVG_WIDTH } from \"./constants\";\n// Get the value at the end of a path in a nested object\nconst midPoint = (_Ax: number, _Ay: number, _Bx: number, _By: number): number[] => {\n  const _Zx = (_Ax - _Bx) / 2 + _Bx;\n  const _Zy = (_Ay - _By) / 2 + _By;\n  return [_Zx, _Zy];\n};\n\nconst getPath = (coords: number[][]): string => {\n  if (!coords.length) {\n    return \"\";\n  }\n\n  let next: number[];\n  let Z: number[];\n  const X = 0;\n  const Y = 1;\n  let path = \"\";\n  let last = coords.filter(Boolean)[0];\n\n  path += `M ${last[X]},${last[Y]}`;\n\n  for (const coord of coords) {\n    next = coord;\n    Z = midPoint(last[X], last[Y], next[X], next[Y]);\n    path += ` ${Z[X]},${Z[Y]}`;\n    path += ` Q${next[X]},${next[Y]}`;\n    last = next;\n  }\n\n  path += ` ${next![X]},${next![Y]}`;\n  return path;\n};\n\nconst SVGWrapper = styled.svg`\n  display: flex;\n  width: 100%;\n  .fill {\n    opacity: 0.1;\n  }\n`;\n\nexport interface SvgGraphProps extends ComponentPropsWithoutRef<\"svg\"> {\n  coordinates?: number[][];\n  strokeWidth?: number;\n}\n\nexport function SvgGraph({ coordinates, strokeWidth = 5, cssStyles, className, ...rest }: SvgGraphProps) {\n  const [path, setPath] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    if (coordinates) {\n      const newPath = getPath(coordinates);\n      setPath(newPath);\n    }\n  }, [coordinates]);\n  // needs to be unique per components so the mask/fill works correctly.\n  // Generate a unique ID for this component instance.\n  const idRef = useRef(`svg-${Math.random().toString(36).substr(2, 9)}`);\n  const id = idRef.current;\n\n  return (\n    <SVGWrapper\n      className={`${className ?? \"\"} svg-graph`}\n      width=\"100%\"\n      height=\"100%\"\n      viewBox={`0 0 ${SVG_WIDTH} ${SVG_HEIGHT}`}\n      css={css`\n        ${cssStyles ?? \"\"}\n      `}\n      {...rest}\n    >\n      <g>\n        {!!path && coordinates ? (\n          <>\n            <mask id={`${id}-fill`}>\n              <path className=\"fill\" fill=\"white\" d={`${path} L 500, 100 L 0, 100 z`} />\n            </mask>\n            <rect height=\"100%\" width=\"100%\" fill=\"var(--ha-A400)\" mask={`url(#${id}-fill)`} />\n            <mask id={`${id}-line`}>\n              <path fill=\"none\" stroke=\"var(--ha-A100)\" strokeWidth={strokeWidth} strokeLinecap=\"round\" strokeLinejoin=\"round\" d={path} />\n            </mask>\n            <rect height=\"100%\" width=\"100%\" fill=\"var(--ha-A400)\" mask={`url(#${id}-line)`} />\n          </>\n        ) : (\n          <></>\n        )}\n      </g>\n    </SVGWrapper>\n  );\n}\n"],"names":["midPoint","_Ax","_Ay","_Bx","_By","_Zx","_Zy","getPath","coords","length","next","Z","X","Y","path","last","filter","Boolean","coord","SVGWrapper","_styled","process","env","NODE_ENV","target","label","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","SvgGraph","coordinates","strokeWidth","cssStyles","className","rest","setPath","useState","undefined","useEffect","newPath","id","useRef","Math","random","substr","current","SVG_WIDTH","SVG_HEIGHT","css","jsx","jsxs","Fragment"],"mappings":"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"}