{"version":3,"file":"index.js","sources":["../../../../src/Shared/SvgGraph/index.tsx"],"sourcesContent":["import { useState, useEffect, useRef, ComponentPropsWithoutRef } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { css } from \"@emotion/react\";\nimport { SVG_HEIGHT, SVG_WIDTH } from \"./constants\";\n// Get the value at the end of a path in a nested object\nconst midPoint = (_Ax: number, _Ay: number, _Bx: number, _By: number): number[] => {\n  const _Zx = (_Ax - _Bx) / 2 + _Bx;\n  const _Zy = (_Ay - _By) / 2 + _By;\n  return [_Zx, _Zy];\n};\n\nconst getPath = (coords: number[][]): string => {\n  if (!coords.length) {\n    return \"\";\n  }\n\n  let next: number[];\n  let Z: number[];\n  const X = 0;\n  const Y = 1;\n  let path = \"\";\n  let last = coords.filter(Boolean)[0];\n\n  path += `M ${last[X]},${last[Y]}`;\n\n  for (const coord of coords) {\n    next = coord;\n    Z = midPoint(last[X], last[Y], next[X], next[Y]);\n    path += ` ${Z[X]},${Z[Y]}`;\n    path += ` Q${next[X]},${next[Y]}`;\n    last = next;\n  }\n\n  path += ` ${next![X]},${next![Y]}`;\n  return path;\n};\n\nconst SVGWrapper = styled.svg`\n  display: flex;\n  width: 100%;\n  .fill {\n    opacity: 0.1;\n  }\n`;\n\nexport interface SvgGraphProps extends ComponentPropsWithoutRef<\"svg\"> {\n  coordinates?: number[][];\n  strokeWidth?: number;\n}\n\nexport function SvgGraph({ coordinates, strokeWidth = 5, cssStyles, className, ...rest }: SvgGraphProps) {\n  const [path, setPath] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    if (coordinates) {\n      const newPath = getPath(coordinates);\n      setPath(newPath);\n    }\n  }, [coordinates]);\n  // needs to be unique per components so the mask/fill works correctly.\n  // Generate a unique ID for this component instance.\n  const idRef = useRef(`svg-${Math.random().toString(36).substr(2, 9)}`);\n  const id = idRef.current;\n\n  return (\n    <SVGWrapper\n      className={`${className ?? \"\"} svg-graph`}\n      width=\"100%\"\n      height=\"100%\"\n      viewBox={`0 0 ${SVG_WIDTH} ${SVG_HEIGHT}`}\n      css={css`\n        ${cssStyles ?? \"\"}\n      `}\n      {...rest}\n    >\n      <g>\n        {!!path && coordinates ? (\n          <>\n            <mask id={`${id}-fill`}>\n              <path className=\"fill\" fill=\"white\" d={`${path} L 500, 100 L 0, 100 z`} />\n            </mask>\n            <rect height=\"100%\" width=\"100%\" fill=\"var(--ha-A400)\" mask={`url(#${id}-fill)`} />\n            <mask id={`${id}-line`}>\n              <path fill=\"none\" stroke=\"var(--ha-A100)\" strokeWidth={strokeWidth} strokeLinecap=\"round\" strokeLinejoin=\"round\" d={path} />\n            </mask>\n            <rect height=\"100%\" width=\"100%\" fill=\"var(--ha-A400)\" mask={`url(#${id}-line)`} />\n          </>\n        ) : (\n          <></>\n        )}\n      </g>\n    </SVGWrapper>\n  );\n}\n"],"names":["midPoint","_Ax","_Ay","_Bx","_By","_Zx","_Zy","getPath","coords","length","next","Z","X","Y","path","last","filter","Boolean","coord","SVGWrapper","_styled","process","env","NODE_ENV","target","label","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","SvgGraph","coordinates","strokeWidth","cssStyles","className","rest","setPath","useState","undefined","useEffect","newPath","id","useRef","Math","random","substr","current","SVG_WIDTH","SVG_HEIGHT","css","jsx","jsxs","Fragment"],"mappings":"kiBAKA,MAAMA,EAAWA,CAACC,EAAaC,EAAaC,EAAaC,IAA0B,CACjF,MAAMC,GAAOJ,EAAME,GAAO,EAAIA,EACxBG,GAAOJ,EAAME,GAAO,EAAIA,EAC9B,MAAO,CAACC,EAAKC,CAAG,CAClB,EAEMC,EAAWC,GAA+B,CAC9C,GAAI,CAACA,EAAOC,OACV,MAAO,GAGT,IAAIC,EACAC,EACJ,MAAMC,EAAI,EACJC,EAAI,EACV,IAAIC,EAAO,GACPC,EAAOP,EAAOQ,OAAOC,OAAO,EAAE,CAAC,EAEnCH,GAAQ,KAAKC,EAAKH,CAAC,CAAC,IAAIG,EAAKF,CAAC,CAAC,GAE/B,UAAWK,KAASV,EAClBE,EAAOQ,EACPP,EAAIX,EAASe,EAAKH,CAAC,EAAGG,EAAKF,CAAC,EAAGH,EAAKE,CAAC,EAAGF,EAAKG,CAAC,CAAC,EAC/CC,GAAQ,IAAIH,EAAEC,CAAC,CAAC,IAAID,EAAEE,CAAC,CAAC,GACxBC,GAAQ,KAAKJ,EAAKE,CAAC,CAAC,IAAIF,EAAKG,CAAC,CAAC,GAC/BE,EAAOL,EAGTI,OAAAA,GAAQ,IAAIJ,EAAME,CAAC,CAAC,IAAIF,EAAMG,CAAC,CAAC,GACzBC,CACT,EAEMK,EAAUC,EAAAA,aAAA,MAAAC,QAAAC,IAAAC,WAAA,aAAA,CAAAC,OAAA,UAAA,EAAA,CAAAA,OAAA,WAAAC,MAAA,YAAA,CAAA,EAAAJ,QAAAC,IAAAC,WAAA,aAAA,CAAAG,KAAA,SAAAC,OAAA,6CAAA,EAAA,CAAAD,KAAA,SAAAC,OAAA,8CAAAC,SAAAC,CAAA,CAAA,EAaT,SAASC,EAAS,CAAEC,YAAAA,EAAaC,YAAAA,EAAc,EAAGC,UAAAA,EAAWC,UAAAA,EAAW,GAAGC,CAAoB,EAAG,CACvG,KAAM,CAACrB,EAAMsB,CAAO,EAAIC,EAAAA,SAA6BC,MAAS,EAE9DC,EAAAA,UAAU,IAAM,CACd,GAAIR,EAAa,CACf,MAAMS,EAAUjC,EAAQwB,CAAW,EACnCK,EAAQI,CAAO,CACjB,CACF,EAAG,CAACT,CAAW,CAAC,EAIhB,MAAMU,EADQC,EAAAA,OAAO,OAAOC,KAAKC,OAAAA,EAAShB,SAAS,EAAE,EAAEiB,OAAO,EAAG,CAAC,CAAC,EAAE,EACpDC,QAEjB,aACG3B,EAAA,CACC,UAAW,GAAGe,GAAa,EAAE,aAC7B,MAAM,OACN,OAAO,OACP,QAAS,OAAOa,EAAAA,SAAS,IAAIC,YAAU,GACvC,IAAKC,MACDhB,GAAa,GAAE,KAAAZ,QAAAC,IAAAC,gDAEnB,GAAIY,EAEJ,SAAAe,MAAC,IAAA,CACE,SAAEpC,GAAQiB,EACToB,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAF,MAAC,OAAA,CAAK,GAAI,GAAGT,CAAE,QACb,SAAAS,EAAAA,IAAC,OAAA,CAAK,UAAU,OAAO,KAAK,QAAQ,EAAG,GAAGpC,CAAI,yBAAyB,EACzE,EACAoC,EAAAA,IAAC,OAAA,CAAK,OAAO,OAAO,MAAM,OAAO,KAAK,iBAAiB,KAAM,QAAQT,CAAE,QAAA,CAAS,QAC/E,OAAA,CAAK,GAAI,GAAGA,CAAE,QACb,eAAC,OAAA,CAAK,KAAK,OAAO,OAAO,iBAAiB,YAAAT,EAA0B,cAAc,QAAQ,eAAe,QAAQ,EAAGlB,EAAK,CAAA,CAC3H,EACAoC,EAAAA,IAAC,OAAA,CAAK,OAAO,OAAO,MAAM,OAAO,KAAK,iBAAiB,KAAM,QAAQT,CAAE,QAAA,CAAS,CAAA,CAAA,CAClF,EAEAS,EAAAA,IAAAE,EAAAA,SAAA,CAAA,CAAE,CAAA,CAEN,CAAA,CACF,CAEJ"}