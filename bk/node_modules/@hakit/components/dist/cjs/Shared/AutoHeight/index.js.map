{"version":3,"file":"index.js","sources":["../../../../src/Shared/AutoHeight/index.tsx"],"sourcesContent":["import React, { useRef, useState, useLayoutEffect } from \"react\";\n\ntype AutoHeightProps = {\n  isOpen: boolean;\n  children: React.ReactNode;\n  duration?: number;\n  className?: string;\n  style?: React.CSSProperties;\n  onCollapseComplete?: () => void;\n};\n\nexport const AutoHeight = ({ isOpen, children, duration = 300, className, style, onCollapseComplete }: AutoHeightProps) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [renderChildren, setRenderChildren] = useState(isOpen);\n  const [shouldAnimate, setShouldAnimate] = useState(true);\n  const hasMountedRef = useRef(false);\n  const animationTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const rafRef = useRef<number | null>(null);\n  const isAnimatingRef = useRef(false);\n\n  // Ensure children are present before measuring during expand\n  useLayoutEffect(() => {\n    const el = containerRef.current;\n    if (!el) return;\n\n    // Cleanup any ongoing animations\n    if (animationTimeoutRef.current) {\n      clearTimeout(animationTimeoutRef.current);\n      animationTimeoutRef.current = null;\n    }\n    if (rafRef.current) {\n      cancelAnimationFrame(rafRef.current);\n      rafRef.current = null;\n    }\n\n    // On first render only\n    if (!hasMountedRef.current) {\n      hasMountedRef.current = true;\n      if (isOpen) {\n        // Start open: skip animation\n        setRenderChildren(true);\n        setShouldAnimate(false);\n        el.style.height = \"auto\";\n        isAnimatingRef.current = false;\n      } else {\n        // Start collapsed: do nothing, wait for open to trigger animation\n        setRenderChildren(false);\n        isAnimatingRef.current = false;\n      }\n      return;\n    }\n\n    // Prevent redundant animations\n    if (isAnimatingRef.current) return;\n\n    if (isOpen) {\n      if (renderChildren && el.style.height === \"auto\") {\n        // Already open and rendered, no need to animate\n        return;\n      }\n\n      isAnimatingRef.current = true;\n      setRenderChildren(true);\n      el.style.height = \"0px\";\n\n      rafRef.current = requestAnimationFrame(() => {\n        const scrollHeight = el.scrollHeight;\n        setShouldAnimate(true);\n        el.style.transition = `height ${duration}ms ease`;\n        el.style.height = `${scrollHeight}px`;\n\n        animationTimeoutRef.current = setTimeout(() => {\n          el.style.transition = \"\";\n          el.style.height = \"auto\";\n          isAnimatingRef.current = false;\n          animationTimeoutRef.current = null;\n        }, duration);\n      });\n    } else {\n      if (!renderChildren) {\n        // Already collapsed, no need to animate\n        return;\n      }\n\n      isAnimatingRef.current = true;\n      const currentHeight = el.scrollHeight;\n      el.style.height = `${currentHeight}px`;\n\n      rafRef.current = requestAnimationFrame(() => {\n        setShouldAnimate(true);\n        el.style.transition = `height ${duration}ms ease`;\n        el.style.height = \"0px\";\n\n        animationTimeoutRef.current = setTimeout(() => {\n          setRenderChildren(false);\n          isAnimatingRef.current = false;\n          animationTimeoutRef.current = null;\n          if (onCollapseComplete) onCollapseComplete();\n        }, duration);\n      });\n    }\n\n    // Cleanup function\n    return () => {\n      if (animationTimeoutRef.current) {\n        clearTimeout(animationTimeoutRef.current);\n        animationTimeoutRef.current = null;\n      }\n      if (rafRef.current) {\n        cancelAnimationFrame(rafRef.current);\n        rafRef.current = null;\n      }\n      isAnimatingRef.current = false;\n    };\n  }, [isOpen, duration, onCollapseComplete, renderChildren]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={className}\n      style={{\n        overflow: \"hidden\",\n        height: isOpen && !shouldAnimate ? \"auto\" : undefined,\n        ...style,\n      }}\n    >\n      {renderChildren ? children : null}\n    </div>\n  );\n};\n"],"names":["AutoHeight","isOpen","children","duration","className","style","onCollapseComplete","containerRef","useRef","renderChildren","setRenderChildren","useState","shouldAnimate","setShouldAnimate","hasMountedRef","animationTimeoutRef","rafRef","isAnimatingRef","useLayoutEffect","el","current","clearTimeout","cancelAnimationFrame","height","requestAnimationFrame","scrollHeight","transition","setTimeout","currentHeight","jsx","overflow","undefined"],"mappings":"kLAWaA,EAAaA,CAAC,CAAEC,OAAAA,EAAQC,SAAAA,EAAUC,SAAAA,EAAW,IAAKC,UAAAA,EAAWC,MAAAA,EAAOC,mBAAAA,CAAoC,IAAM,CACzH,MAAMC,EAAeC,EAAAA,OAAuB,IAAI,EAC1C,CAACC,EAAgBC,CAAiB,EAAIC,EAAAA,SAASV,CAAM,EACrD,CAACW,EAAeC,CAAgB,EAAIF,EAAAA,SAAS,EAAI,EACjDG,EAAgBN,EAAAA,OAAO,EAAK,EAC5BO,EAAsBP,EAAAA,OAA8B,IAAI,EACxDQ,EAASR,EAAAA,OAAsB,IAAI,EACnCS,EAAiBT,EAAAA,OAAO,EAAK,EAGnCU,OAAAA,EAAAA,gBAAgB,IAAM,CACpB,MAAMC,EAAKZ,EAAaa,QACxB,GAAKD,EAaL,IAVIJ,EAAoBK,UACtBC,aAAaN,EAAoBK,OAAO,EACxCL,EAAoBK,QAAU,MAE5BJ,EAAOI,UACTE,qBAAqBN,EAAOI,OAAO,EACnCJ,EAAOI,QAAU,MAIf,CAACN,EAAcM,QAAS,CAC1BN,EAAcM,QAAU,GACpBnB,GAEFS,EAAkB,EAAI,EACtBG,EAAiB,EAAK,EACtBM,EAAGd,MAAMkB,OAAS,OAClBN,EAAeG,QAAU,KAGzBV,EAAkB,EAAK,EACvBO,EAAeG,QAAU,IAE3B,MACF,CAGA,GAAIH,CAAAA,EAAeG,QAEnB,IAAInB,EAAQ,CACV,GAAIQ,GAAkBU,EAAGd,MAAMkB,SAAW,OAExC,OAGFN,EAAeG,QAAU,GACzBV,EAAkB,EAAI,EACtBS,EAAGd,MAAMkB,OAAS,MAElBP,EAAOI,QAAUI,sBAAsB,IAAM,CAC3C,MAAMC,EAAeN,EAAGM,aACxBZ,EAAiB,EAAI,EACrBM,EAAGd,MAAMqB,WAAa,UAAUvB,CAAQ,UACxCgB,EAAGd,MAAMkB,OAAS,GAAGE,CAAY,KAEjCV,EAAoBK,QAAUO,WAAW,IAAM,CAC7CR,EAAGd,MAAMqB,WAAa,GACtBP,EAAGd,MAAMkB,OAAS,OAClBN,EAAeG,QAAU,GACzBL,EAAoBK,QAAU,IAChC,EAAGjB,CAAQ,CACb,CAAC,CACH,KAAO,CACL,GAAI,CAACM,EAEH,OAGFQ,EAAeG,QAAU,GACzB,MAAMQ,EAAgBT,EAAGM,aACzBN,EAAGd,MAAMkB,OAAS,GAAGK,CAAa,KAElCZ,EAAOI,QAAUI,sBAAsB,IAAM,CAC3CX,EAAiB,EAAI,EACrBM,EAAGd,MAAMqB,WAAa,UAAUvB,CAAQ,UACxCgB,EAAGd,MAAMkB,OAAS,MAElBR,EAAoBK,QAAUO,WAAW,IAAM,CAC7CjB,EAAkB,EAAK,EACvBO,EAAeG,QAAU,GACzBL,EAAoBK,QAAU,KAC1Bd,GAAoBA,EAAAA,CAC1B,EAAGH,CAAQ,CACb,CAAC,CACH,CAGA,MAAO,IAAM,CACPY,EAAoBK,UACtBC,aAAaN,EAAoBK,OAAO,EACxCL,EAAoBK,QAAU,MAE5BJ,EAAOI,UACTE,qBAAqBN,EAAOI,OAAO,EACnCJ,EAAOI,QAAU,MAEnBH,EAAeG,QAAU,EAC3B,GACF,EAAG,CAACnB,EAAQE,EAAUG,EAAoBG,CAAc,CAAC,EAGvDoB,EAAAA,IAAC,MAAA,CACC,IAAKtB,EACL,UAAAH,EACA,MAAO,CACL0B,SAAU,SACVP,OAAQtB,GAAU,CAACW,EAAgB,OAASmB,OAC5C,GAAG1B,CAAAA,EAGJI,SAAAA,EAAiBP,EAAW,IAAA,CAC/B,CAEJ"}