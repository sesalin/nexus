{"version":3,"file":"index.js","sources":["../../../../../src/Cards/CameraCard/players/index.tsx"],"sourcesContent":["import { useEffect, useRef, useCallback, useImperativeHandle, forwardRef } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { localize } from \"@hakit/core\";\n\nexport type VideoState = \"canplay\" | \"canplaythrough\" | \"waiting\" | \"stalled\" | \"loadeddata\" | \"play\" | \"playing\" | \"pause\";\n\nexport interface VideoPlayerProps extends Omit<React.HTMLProps<HTMLVideoElement>, \"as\"> {\n  src?: string;\n  type?: string;\n  onVideoStateChange?: (state: VideoState) => void;\n}\n\nconst Video = styled.video`\n  display: block;\n  width: 100%;\n`;\n\nexport const VideoPlayer = forwardRef<HTMLVideoElement, VideoPlayerProps>(({ src, type, onVideoStateChange, ...rest }, ref) => {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n\n  useImperativeHandle(ref, () => videoRef.current!);\n\n  const notifyStateChange = useCallback(\n    (state: VideoState) => {\n      if (onVideoStateChange) {\n        onVideoStateChange(state);\n      }\n    },\n    [onVideoStateChange],\n  );\n\n  useEffect(() => {\n    const videoElement = videoRef.current;\n\n    const handleCanPlay = () => {\n      notifyStateChange(\"canplay\");\n    };\n\n    const handleCanPlayThrough = () => {\n      notifyStateChange(\"canplaythrough\");\n    };\n\n    const handleWaiting = () => {\n      notifyStateChange(\"waiting\");\n    };\n\n    const handleStalled = () => {\n      notifyStateChange(\"stalled\");\n    };\n\n    const handleLoadedData = () => {\n      notifyStateChange(\"loadeddata\");\n    };\n    const handlePlay = () => {\n      notifyStateChange(\"play\");\n    };\n    const handlePlaying = () => {\n      notifyStateChange(\"playing\");\n    };\n    const handlePause = () => {\n      notifyStateChange(\"pause\");\n    };\n\n    if (videoElement) {\n      videoElement.addEventListener(\"canplay\", handleCanPlay);\n      videoElement.addEventListener(\"canplaythrough\", handleCanPlayThrough);\n      videoElement.addEventListener(\"waiting\", handleWaiting);\n      videoElement.addEventListener(\"stalled\", handleStalled);\n      videoElement.addEventListener(\"loadeddata\", handleLoadedData);\n      videoElement.addEventListener(\"playing\", handlePlaying);\n      videoElement.addEventListener(\"play\", handlePlay);\n      videoElement.addEventListener(\"pause\", handlePause);\n    }\n\n    return () => {\n      if (videoElement) {\n        videoElement.removeEventListener(\"canplay\", handleCanPlay);\n        videoElement.removeEventListener(\"canplaythrough\", handleCanPlayThrough);\n        videoElement.removeEventListener(\"waiting\", handleWaiting);\n        videoElement.removeEventListener(\"stalled\", handleStalled);\n        videoElement.removeEventListener(\"loadeddata\", handleLoadedData);\n        videoElement.removeEventListener(\"playing\", handlePlaying);\n        videoElement.removeEventListener(\"play\", handlePlay);\n        videoElement.removeEventListener(\"pause\", handlePause);\n      }\n    };\n  }, [notifyStateChange]);\n\n  return (\n    <Video ref={videoRef} {...rest}>\n      <source src={src} type={type} />\n      {localize(\"fields.format.description\")}\n    </Video>\n  );\n});\n\nVideoPlayer.displayName = \"VideoPlayer\";\n"],"names":["Video","_styled","process","env","NODE_ENV","target","label","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","VideoPlayer","forwardRef","src","type","onVideoStateChange","rest","ref","videoRef","useRef","useImperativeHandle","current","notifyStateChange","useCallback","state","useEffect","videoElement","handleCanPlay","handleCanPlayThrough","handleWaiting","handleStalled","handleLoadedData","handlePlay","handlePlaying","handlePause","addEventListener","removeEventListener","jsxs","jsx","localize","displayName"],"mappings":"ygBAYA,MAAMA,EAAKC,EAAAA,aAAA,QAAAC,QAAAC,IAAAC,WAAA,aAAA,CAAAC,OAAA,WAAA,EAAA,CAAAA,OAAA,YAAAC,MAAA,OAAA,CAAA,EAAAJ,QAAAC,IAAAC,WAAA,aAAA,CAAAG,KAAA,UAAAC,OAAA,0BAAA,EAAA,CAAAD,KAAA,UAAAC,OAAA,2BAAAC,SAAAC,CAAA,CAAA,EAKEC,EAAcC,EAAAA,WAA+C,CAAC,CAAEC,IAAAA,EAAKC,KAAAA,EAAMC,mBAAAA,EAAoB,GAAGC,CAAK,EAAGC,IAAQ,CAC7H,MAAMC,EAAWC,EAAAA,OAAgC,IAAI,EAErDC,EAAAA,oBAAoBH,EAAK,IAAMC,EAASG,OAAQ,EAEhD,MAAMC,EAAoBC,cACvBC,GAAsB,CACjBT,GACFA,EAAmBS,CAAK,CAE5B,EACA,CAACT,CAAkB,CACrB,EAEAU,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAeR,EAASG,QAExBM,EAAgBA,IAAM,CAC1BL,EAAkB,SAAS,CAC7B,EAEMM,EAAuBA,IAAM,CACjCN,EAAkB,gBAAgB,CACpC,EAEMO,EAAgBA,IAAM,CAC1BP,EAAkB,SAAS,CAC7B,EAEMQ,EAAgBA,IAAM,CAC1BR,EAAkB,SAAS,CAC7B,EAEMS,EAAmBA,IAAM,CAC7BT,EAAkB,YAAY,CAChC,EACMU,EAAaA,IAAM,CACvBV,EAAkB,MAAM,CAC1B,EACMW,EAAgBA,IAAM,CAC1BX,EAAkB,SAAS,CAC7B,EACMY,EAAcA,IAAM,CACxBZ,EAAkB,OAAO,CAC3B,EAEA,OAAII,IACFA,EAAaS,iBAAiB,UAAWR,CAAa,EACtDD,EAAaS,iBAAiB,iBAAkBP,CAAoB,EACpEF,EAAaS,iBAAiB,UAAWN,CAAa,EACtDH,EAAaS,iBAAiB,UAAWL,CAAa,EACtDJ,EAAaS,iBAAiB,aAAcJ,CAAgB,EAC5DL,EAAaS,iBAAiB,UAAWF,CAAa,EACtDP,EAAaS,iBAAiB,OAAQH,CAAU,EAChDN,EAAaS,iBAAiB,QAASD,CAAW,GAG7C,IAAM,CACPR,IACFA,EAAaU,oBAAoB,UAAWT,CAAa,EACzDD,EAAaU,oBAAoB,iBAAkBR,CAAoB,EACvEF,EAAaU,oBAAoB,UAAWP,CAAa,EACzDH,EAAaU,oBAAoB,UAAWN,CAAa,EACzDJ,EAAaU,oBAAoB,aAAcL,CAAgB,EAC/DL,EAAaU,oBAAoB,UAAWH,CAAa,EACzDP,EAAaU,oBAAoB,OAAQJ,CAAU,EACnDN,EAAaU,oBAAoB,QAASF,CAAW,EAEzD,CACF,EAAG,CAACZ,CAAiB,CAAC,EAGpBe,EAAAA,KAACrC,EAAA,CAAM,IAAKkB,EAAU,GAAIF,EACxB,SAAA,CAAAsB,EAAAA,IAAC,SAAA,CAAO,IAAAzB,EAAU,KAAAC,CAAA,CAAW,EAC5ByB,EAAAA,SAAS,2BAA2B,CAAA,EACvC,CAEJ,CAAC,EAED5B,EAAY6B,YAAc"}