import { Connection, HassEntities, HassEntity } from 'home-assistant-js-websocket';
import { LightColor } from '../types/autogenerated-types-by-domain';
import { AreaRegistryEntry, DeviceRegistryEntry, FloorRegistryEntry } from '../hooks';
type EntityCategory = "config" | "diagnostic";
export interface RegistryEntry {
    created_at: number;
    modified_at: number;
}
export interface EntityRegistryDisplayEntry {
    entity_id: string;
    name?: string;
    icon?: string;
    device_id?: string;
    area_id?: string;
    labels: string[];
    hidden?: boolean;
    entity_category?: EntityCategory;
    translation_key?: string;
    platform?: string;
    display_precision?: number;
    has_entity_name?: boolean;
}
export interface EntityRegistryDisplayEntryResponse {
    entities: {
        ei: string;
        di?: string;
        ai?: string;
        lb: string[];
        ec?: number;
        en?: string;
        ic?: string;
        pl?: string;
        tk?: string;
        hb?: boolean;
        dp?: number;
        hn?: boolean;
    }[];
    entity_categories: Record<number, EntityCategory>;
}
export interface EntityRegistryEntry extends RegistryEntry {
    id: string;
    entity_id: string;
    name: string | null;
    icon: string | null;
    platform: string;
    config_entry_id: string | null;
    config_subentry_id: string | null;
    device_id: string | null;
    area_id: string | null;
    labels: string[];
    disabled_by: "user" | "device" | "integration" | "config_entry" | null;
    hidden_by: Exclude<EntityRegistryEntry["disabled_by"], "config_entry">;
    entity_category: EntityCategory | null;
    has_entity_name: boolean;
    original_name?: string;
    unique_id: string;
    translation_key?: string;
    options: EntityRegistryOptions | null;
    categories: Record<string, string>;
}
export interface ExtEntityRegistryEntry extends EntityRegistryEntry {
    capabilities: Record<string, unknown>;
    original_icon?: string;
    device_class?: string;
    original_device_class?: string;
    aliases: string[];
}
export interface UpdateEntityRegistryEntryResult {
    entity_entry: ExtEntityRegistryEntry;
    reload_delay?: number;
    require_restart?: boolean;
}
export interface SensorEntityOptions {
    display_precision?: number | null;
    suggested_display_precision?: number | null;
    unit_of_measurement?: string | null;
}
export interface LightEntityOptions {
    favorite_colors?: LightColor[];
}
export interface NumberEntityOptions {
    unit_of_measurement?: string | null;
}
export interface LockEntityOptions {
    default_code?: string | null;
}
export interface AlarmControlPanelEntityOptions {
    default_code?: string | null;
}
export interface WeatherEntityOptions {
    precipitation_unit?: string | null;
    pressure_unit?: string | null;
    temperature_unit?: string | null;
    visibility_unit?: string | null;
    wind_speed_unit?: string | null;
}
export interface SwitchAsXEntityOptions {
    entity_id: string;
    invert: boolean;
}
export interface EntityRegistryOptions {
    number?: NumberEntityOptions;
    sensor?: SensorEntityOptions;
    alarm_control_panel?: AlarmControlPanelEntityOptions;
    lock?: LockEntityOptions;
    weather?: WeatherEntityOptions;
    light?: LightEntityOptions;
    switch_as_x?: SwitchAsXEntityOptions;
    conversation?: Record<string, unknown>;
    "cloud.alexa"?: Record<string, unknown>;
    "cloud.google_assistant"?: Record<string, unknown>;
}
export interface EntityRegistryEntryUpdateParams {
    name?: string | null;
    icon?: string | null;
    device_class?: string | null;
    area_id?: string | null;
    disabled_by?: string | null;
    hidden_by: string | null;
    new_entity_id?: string;
    options_domain?: string;
    options?: SensorEntityOptions | NumberEntityOptions | LockEntityOptions | AlarmControlPanelEntityOptions | WeatherEntityOptions | LightEntityOptions;
    aliases?: string[];
    labels?: string[];
    categories?: Record<string, string | null>;
}
/**
 * Find the most relevant battery entity from a list of registry display entries.
 *
 * Prioritization order is defined in `batteryPriorities` (sensor > binary_sensor).
 * A matching entity must have `attributes.device_class === "battery"` and its domain
 * must appear in the priorities list. The first item after sorting by domain priority is returned.
 *
 * @template T extends object containing an `entity_id` field.
 * @param hassEntities Full Home Assistant entity state map.
 * @param entities Candidate list (typically registry entries or simplified objects with entity_id).
 * @returns The highest priority battery entity or `undefined` if none match.
 */
export declare const findBatteryEntity: <T extends {
    entity_id: string;
}>(hassEntities: HassEntities, entities: T[]) => T | undefined;
/**
 * Locate a battery charging entity (device_class === "battery_charging") in the provided list.
 * Returns the first match; no domain prioritization is applied.
 *
 * @template T extends object containing an `entity_id` field.
 * @param hassEntities Full HA entity state map.
 * @param entities Candidate list.
 * @returns A matching charging entity or `undefined` if not found.
 */
export declare const findBatteryChargingEntity: <T extends {
    entity_id: string;
}>(hassEntities: HassEntities, entities: T[]) => T | undefined;
/**
 * Compute a human readable name for an entity registry entry.
 *
 * Resolution order:
 * 1. Explicit `entry.name`
 * 2. Derived friendly state name (via `computeStateName`)
 * 3. Original name (`entry.original_name`) or fallback to `entry.entity_id`.
 *
 * @param hassEntities Full HA entity state map.
 * @param entry The registry entry we want to name.
 * @returns Resolved name or `null` if not determinable.
 */
export declare const computeEntityRegistryName: (hassEntities: HassEntities, entry: EntityRegistryEntry) => string | null;
/**
 * Fetch a single extended entity registry entry from Home Assistant.
 *
 * This issues a WebSocket command (`config/entity_registry/get`) via `sendMessagePromise`.
 *
 * @param connection Active HA websocket connection.
 * @param entityId Target entity_id to retrieve extended registry info for.
 * @returns Promise resolving to the extended registry entry.
 */
export declare const getExtendedEntityRegistryEntry: (connection: Connection, entityId: string) => Promise<ExtEntityRegistryEntry>;
/**
 * Fetch multiple extended entity registry entries in a single request.
 *
 * Issues `config/entity_registry/get_entries` with an array of ids.
 *
 * @param connection Active HA websocket connection.
 * @param entityIds Array of entity_ids to fetch.
 * @returns Promise resolving to a keyed record (entity_id -> extended entry).
 */
export declare const getExtendedEntityRegistryEntries: (connection: Connection, entityIds: string[]) => Promise<Record<string, ExtEntityRegistryEntry>>;
/**
 * Update an existing entity registry entry.
 *
 * Issues `config/entity_registry/update` with partial update fields.
 * Supports renaming, area assignment, icon/device_class changes, and options updates.
 *
 * @param connection HA websocket connection.
 * @param entityId Target entity_id.
 * @param updates Partial set of fields to update.
 * @returns Promise resolving to the update result (may include restart or reload hints).
 */
export declare const updateEntityRegistryEntry: (connection: Connection, entityId: string, updates: Partial<EntityRegistryEntryUpdateParams>) => Promise<UpdateEntityRegistryEntryResult>;
/**
 * Remove an entity from the registry (may not remove underlying integration/device).
 *
 * Issues `config/entity_registry/remove`.
 *
 * @param connection HA websocket connection.
 * @param entityId The entity_id to remove.
 * @returns Promise resolving when removal is acknowledged.
 */
export declare const removeEntityRegistryEntry: (connection: Connection, entityId: string) => Promise<void>;
/**
 * Retrieve compact display-friendly registry entries.
 *
 * Issues `config/entity_registry/list_for_display`, returning a structure optimized
 * for UI listing (with short keys and separate category mapping).
 *
 * @param connection HA websocket connection.
 * @returns Promise resolving to display entry response payload.
 */
export declare const fetchEntityRegistryDisplay: (connection: Connection) => Promise<EntityRegistryDisplayEntryResponse>;
export declare const subscribeEntityRegistryDisplay: (conn: Connection, onChange: (entities: EntityRegistryDisplayEntryResponse) => void) => import('home-assistant-js-websocket').UnsubscribeFunc;
/**
 * Sort registry entries by their explicit name (locale-aware case-insensitive).
 *
 * @param entries Registry entries array (mutated in place by Array.sort).
 * @param language Locale/language code for comparison rules.
 * @returns The same array reference sorted.
 */
export declare const sortEntityRegistryByName: (entries: EntityRegistryEntry[], language: string) => EntityRegistryEntry[];
/**
 * Build a lookup map keyed by `entity_id` for quick access.
 *
 * @param entries Array of registry entries.
 * @returns Record mapping entity_id -> entry.
 */
export declare const entityRegistryByEntityId: (entries: EntityRegistryEntry[]) => Record<string, EntityRegistryEntry>;
/**
 * Build a lookup map keyed by internal registry `id`.
 *
 * @param entries Array of registry entries.
 * @returns Record mapping registry id -> entry.
 */
export declare const entityRegistryById: (entries: EntityRegistryEntry[]) => Record<string, EntityRegistryEntry>;
/**
 * Produce a mapping from entity_id to integration platform name.
 * Ignores entries lacking a platform.
 *
 * @param entities Registry entries.
 * @returns Record entity_id -> platform string.
 */
export declare const getEntityPlatformLookup: (entities: EntityRegistryEntry[]) => Record<string, string>;
/**
 * Ask Home Assistant for automatically suggested entity_ids for given IDs.
 *
 * Issues `config/entity_registry/get_automatic_entity_ids`.
 *
 * @param connection HA websocket connection.
 * @param entity_ids List of entity IDs to query.
 * @returns Promise resolving to a mapping of original id -> suggested new id (or null).
 */
export declare const getAutomaticEntityIds: (connection: Connection, entity_ids: string[]) => Promise<Record<string, string | null>>;
export interface EntityListInfoCommon {
    id: string;
    primary: string;
    secondary?: string;
    search_labels?: string[];
    sorting_label?: string;
    icon_path?: string;
    icon?: string;
}
export interface EntityListInfo extends EntityListInfoCommon {
    domain_name?: string;
    stateObj?: HassEntity;
}
/**
 * Build a filtered & decorated list of entity metadata for UI consumption.
 *
 * Applies domain/entity include & exclude filters, device class filtering, unit filtering,
 * custom predicate filtering, and search label composition. Produces a stable list of
 * `EntityListInfo` objects with primary/secondary labels.
 *
 * @param hassEntities Raw HA entities state map.
 * @param entities Display registry entry map (entity_id -> display entry) used for name resolution.
 * @param devices Device registry map (device_id -> device entry) for hierarchical naming.
 * @param areas Area registry map (area_id -> area entry) for hierarchical naming.
 * @param floors Floor registry map (floor_id -> floor entry) for hierarchical naming.
 * @param includeDomains Domains to explicitly include (optional).
 * @param excludeDomains Domains to explicitly exclude (optional).
 * @param entityFilter Additional predicate applied to each HassEntity (optional).
 * @param includeDeviceClasses Device classes to include (optional).
 * @param includeUnitOfMeasurement Units of measurement to include (optional).
 * @param includeEntities Explicit entity_ids to include (optional).
 * @param excludeEntities Explicit entity_ids to exclude (optional).
 * @param value A selected value whose entity should always be retained in filtering (optional).
 * @param idPrefix Prefix applied to generated `id` field (defaults to '').
 * @returns Filtered, mapped array of `EntityListInfo` objects.
 */
export declare const getEntities: (hassEntities: HassEntities, entities: Record<string, EntityRegistryDisplayEntry>, devices: Record<string, DeviceRegistryEntry>, areas: Record<string, AreaRegistryEntry>, floors: Record<string, FloorRegistryEntry>, includeDomains?: string[], excludeDomains?: string[], entityFilter?: (entityId: HassEntity) => boolean, includeDeviceClasses?: string[], includeUnitOfMeasurement?: string[], includeEntities?: string[], excludeEntities?: string[], value?: string, idPrefix?: string) => EntityListInfo[];
export {};
//# sourceMappingURL=entity_registry.d.ts.map