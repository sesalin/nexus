{"version":3,"file":"entities.js","sources":["../../../../src/utils/subscribe/entities.ts"],"sourcesContent":["import { Connection, createCollection } from \"home-assistant-js-websocket\";\nimport { Store } from \"home-assistant-js-websocket/dist/store.js\";\nimport { debounce } from \"lodash\";\nimport { EntityRegistryEntry } from \"@utils/entity_registry\";\n\nconst fetchEntityRegistry = (conn: Connection) =>\n  conn.sendMessagePromise<EntityRegistryEntry[]>({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeEntityRegistryUpdates = (conn: Connection, store: Store<EntityRegistryEntry[]>) =>\n  conn.subscribeEvents(\n    debounce(() => fetchEntityRegistry(conn).then((entities) => store.setState(entities, true)), 500, {\n      leading: true,\n      trailing: true,\n    }),\n    \"entity_registry_updated\",\n  );\n\nexport const subscribeEntityRegistry = (conn: Connection, onChange: (entities: EntityRegistryEntry[]) => void) =>\n  createCollection<EntityRegistryEntry[]>(\"_entityRegistry\", fetchEntityRegistry, subscribeEntityRegistryUpdates, conn, onChange);\n"],"names":["fetchEntityRegistry","conn","subscribeEntityRegistryUpdates","store","debounce","entities","subscribeEntityRegistry","onChange","createCollection"],"mappings":"mJAKMA,EAAuBC,GAC3BA,EAAK,mBAA0C,CAC7C,KAAM,6BACR,CAAC,EAEGC,EAAiC,CAACD,EAAkBE,IACxDF,EAAK,gBACHG,EAAAA,SAAS,IAAMJ,EAAoBC,CAAI,EAAE,KAAMI,GAAaF,EAAM,SAASE,EAAU,EAAI,CAAC,EAAG,IAAK,CAChG,QAAS,GACT,SAAU,EAAA,CACX,EACD,yBACF,EAEWC,EAA0B,CAACL,EAAkBM,IACxDC,EAAAA,iBAAwC,kBAAmBR,EAAqBE,EAAgCD,EAAMM,CAAQ"}