{"version":3,"file":"floors.js","sources":["../../../../src/utils/subscribe/floors.ts"],"sourcesContent":["import { RegistryEntry } from \"@utils/entity_registry\";\nimport { Connection, createCollection } from \"home-assistant-js-websocket\";\nimport { Store } from \"home-assistant-js-websocket/dist/store.js\";\nimport { debounce } from \"lodash\";\n\nexport interface FloorRegistryEntry extends RegistryEntry {\n  floor_id: string;\n  name: string;\n  level: number | null;\n  icon: string | null;\n  aliases: string[];\n}\n\nconst fetchFloorRegistry = (conn: Connection) =>\n  conn.sendMessagePromise<FloorRegistryEntry[]>({\n    type: \"config/floor_registry/list\",\n  });\n\nconst subscribeFloorRegistryUpdates = (conn: Connection, store: Store<FloorRegistryEntry[]>) =>\n  conn.subscribeEvents(\n    debounce(() => fetchFloorRegistry(conn).then((areas: FloorRegistryEntry[]) => store.setState(areas, true)), 500, {\n      leading: true,\n      trailing: true,\n    }),\n    \"floor_registry_updated\",\n  );\n\nexport const subscribeFloorRegistry = (conn: Connection, onChange: (floors: FloorRegistryEntry[]) => void) =>\n  createCollection<FloorRegistryEntry[]>(\"_floorRegistry\", fetchFloorRegistry, subscribeFloorRegistryUpdates, conn, onChange);\n"],"names":["fetchFloorRegistry","conn","subscribeFloorRegistryUpdates","store","debounce","areas","subscribeFloorRegistry","onChange","createCollection"],"mappings":"mJAaMA,EAAsBC,GAC1BA,EAAK,mBAAyC,CAC5C,KAAM,4BACR,CAAC,EAEGC,EAAgC,CAACD,EAAkBE,IACvDF,EAAK,gBACHG,EAAAA,SAAS,IAAMJ,EAAmBC,CAAI,EAAE,KAAMI,GAAgCF,EAAM,SAASE,EAAO,EAAI,CAAC,EAAG,IAAK,CAC/G,QAAS,GACT,SAAU,EAAA,CACX,EACD,wBACF,EAEWC,EAAyB,CAACL,EAAkBM,IACvDC,EAAAA,iBAAuC,iBAAkBR,EAAoBE,EAA+BD,EAAMM,CAAQ"}