{"version":3,"file":"colors.js","sources":["../../../src/utils/colors.ts"],"sourcesContent":["import { HassEntity } from \"home-assistant-js-websocket\";\nimport { hs2rgb, rgb2hex } from \"./colors/convert-color\";\nimport { rgbw2rgb, rgbww2rgb, temperature2rgb } from \"./colors/convert-light-color\";\nimport { stateColorBrightness } from \"./colors/index\";\nimport { lightSupportsBrightness } from \"./light\";\nimport { HassEntityWithService } from \"@core\";\n\nfunction toRGB(entity: HassEntity): [number, number, number] | null {\n  if (entity.attributes) {\n    if (\"hs_color\" in entity.attributes && entity.attributes.hs_color !== null) {\n      return hs2rgb([entity.attributes.hs_color[0], entity.attributes.hs_color[1] / 100]);\n    }\n    if (\"color_temp_kelvin\" in entity.attributes && entity.attributes.color_temp_kelvin !== null) {\n      return temperature2rgb(entity.attributes.color_temp_kelvin);\n    }\n    if (\"rgb_color\" in entity.attributes && entity.attributes.rgb_color !== null) {\n      return entity.attributes.rgb_color;\n    }\n    if (\"rgbw_color\" in entity.attributes && entity.attributes.rgbw_color !== null) {\n      return rgbw2rgb(entity.attributes.rgbw_color);\n    }\n    if (\"rgbww_color\" in entity.attributes && entity.attributes.rgbww_color !== null) {\n      return rgbww2rgb(entity.attributes.rgbww_color, entity.attributes.min_color_temp_kelvin, entity.attributes.max_color_temp_kelvin);\n    }\n    // if we reach this point, and the light does support brightness, just fake a kelvin color\n    if (lightSupportsBrightness(entity as HassEntityWithService<\"light\">)) {\n      return temperature2rgb(2000);\n    }\n  }\n\n  return null;\n}\n\nexport function getCssColorValue(entity: HassEntity | null) {\n  const color = entity ? toRGB(entity) : null;\n  // we round the values here so the change in decimal place doesn't trigger\n  // the react render cycle\n  const roundedColor = color ? color.map((x) => x.toFixed(0)).map(Number) : null;\n  // TODO - These are hard coded @hakit/component variables, rather than these css variables we should\n  // expose functionality to either provide these values, or return null and let the consuming app provide defaults\n  const hexColor = color ? rgb2hex(color) : \"var(--ha-A400)\";\n  const rgbColor = roundedColor ? `rgba(${roundedColor.join(\", \")})` : \"var(--ha-S500-contrast)\";\n  const rgbaColor = roundedColor ? `rgba(${[...roundedColor, 0.35].join(\", \")})` : \"var(--ha-A200)\";\n  const { css, raw } = stateColorBrightness(entity);\n  return {\n    color: color || [33, 33, 33],\n    hexColor,\n    rgbColor,\n    rgbaColor,\n    brightness: css,\n    brightnessValue: raw,\n  };\n}\n"],"names":["toRGB","entity","hs2rgb","temperature2rgb","rgbw2rgb","rgbww2rgb","lightSupportsBrightness","getCssColorValue","color","roundedColor","x","hexColor","rgb2hex","rgbColor","rgbaColor","css","raw","stateColorBrightness"],"mappings":"+OAOA,SAASA,EAAMC,EAAqD,CAClE,GAAIA,EAAO,WAAY,CACrB,GAAI,aAAcA,EAAO,YAAcA,EAAO,WAAW,WAAa,KACpE,OAAOC,EAAAA,OAAO,CAACD,EAAO,WAAW,SAAS,CAAC,EAAGA,EAAO,WAAW,SAAS,CAAC,EAAI,GAAG,CAAC,EAEpF,GAAI,sBAAuBA,EAAO,YAAcA,EAAO,WAAW,oBAAsB,KACtF,OAAOE,kBAAgBF,EAAO,WAAW,iBAAiB,EAE5D,GAAI,cAAeA,EAAO,YAAcA,EAAO,WAAW,YAAc,KACtE,OAAOA,EAAO,WAAW,UAE3B,GAAI,eAAgBA,EAAO,YAAcA,EAAO,WAAW,aAAe,KACxE,OAAOG,WAASH,EAAO,WAAW,UAAU,EAE9C,GAAI,gBAAiBA,EAAO,YAAcA,EAAO,WAAW,cAAgB,KAC1E,OAAOI,YAAUJ,EAAO,WAAW,YAAaA,EAAO,WAAW,sBAAuBA,EAAO,WAAW,qBAAqB,EAGlI,GAAIK,EAAAA,wBAAwBL,CAAwC,EAClE,OAAOE,EAAAA,gBAAgB,GAAI,CAE/B,CAEA,OAAO,IACT,CAEO,SAASI,EAAiBN,EAA2B,CAC1D,MAAMO,EAAQP,EAASD,EAAMC,CAAM,EAAI,KAGjCQ,EAAeD,EAAQA,EAAM,IAAKE,GAAMA,EAAE,QAAQ,CAAC,CAAC,EAAE,IAAI,MAAM,EAAI,KAGpEC,EAAWH,EAAQI,UAAQJ,CAAK,EAAI,iBACpCK,EAAWJ,EAAe,QAAQA,EAAa,KAAK,IAAI,CAAC,IAAM,0BAC/DK,EAAYL,EAAe,QAAQ,CAAC,GAAGA,EAAc,GAAI,EAAE,KAAK,IAAI,CAAC,IAAM,iBAC3E,CAAE,IAAAM,EAAK,IAAAC,GAAQC,EAAAA,qBAAqBhB,CAAM,EAChD,MAAO,CACL,MAAOO,GAAS,CAAC,GAAI,GAAI,EAAE,EAC3B,SAAAG,EACA,SAAAE,EACA,UAAAC,EACA,WAAYC,EACZ,gBAAiBC,CAAA,CAErB"}