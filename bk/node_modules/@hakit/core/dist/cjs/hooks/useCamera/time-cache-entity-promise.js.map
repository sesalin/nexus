{"version":3,"file":"time-cache-entity-promise.js","sources":["../../../../src/hooks/useCamera/time-cache-entity-promise.ts"],"sourcesContent":["import { Connection } from \"home-assistant-js-websocket\";\n\ninterface ResultCache<T> {\n  [entityId: string]: { timestamp: number; promise: Promise<T> } | undefined;\n}\n\nconst cache: ResultCache<unknown> = {}; // Replace 'unknown' with your data type if known\n\n/**\n * Call a function with result caching per entity.\n * @param cacheKey key to store the cache on hass object\n * @param cacheTime time to cache the results\n * @param func function to fetch the data\n * @param connection Home Assistant connection object\n * @param entityId entity to fetch data for\n * @param args extra arguments to pass to the function to fetch the data\n * @returns\n */\nexport const timeCacheEntityPromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (connection: Connection, entityId: string, ...args: unknown[]) => Promise<T>,\n  connection: Connection,\n  entityId: string,\n  ...args: unknown[]\n): Promise<T> => {\n  const currentTime = Date.now();\n  const _cacheKey = `${cacheKey}-${entityId}`;\n\n  // Check if the result is in the cache and still valid\n  const cacheEntry = cache[_cacheKey];\n  if (cacheEntry && currentTime - cacheEntry.timestamp < cacheTime) {\n    return cacheEntry.promise as Promise<T>;\n  }\n\n  // Otherwise, fetch the result and update the cache\n  const resultPromise = func(connection, entityId, ...args);\n  cache[_cacheKey] = { timestamp: currentTime, promise: resultPromise };\n\n  return resultPromise;\n};\n"],"names":["cache","timeCacheEntityPromiseFunc","cacheKey","cacheTime","func","connection","entityId","args","currentTime","_cacheKey","cacheEntry","resultPromise"],"mappings":"gFAMA,MAAMA,EAA8B,CAAA,EAYvBC,EAA6B,MACxCC,EACAC,EACAC,EACAC,EACAC,KACGC,IACY,CACf,MAAMC,EAAc,KAAK,IAAA,EACnBC,EAAY,GAAGP,CAAQ,IAAII,CAAQ,GAGnCI,EAAaV,EAAMS,CAAS,EAClC,GAAIC,GAAcF,EAAcE,EAAW,UAAYP,EACrD,OAAOO,EAAW,QAIpB,MAAMC,EAAgBP,EAAKC,EAAYC,EAAU,GAAGC,CAAI,EACxD,OAAAP,EAAMS,CAAS,EAAI,CAAE,UAAWD,EAAa,QAASG,CAAA,EAE/CA,CACT"}