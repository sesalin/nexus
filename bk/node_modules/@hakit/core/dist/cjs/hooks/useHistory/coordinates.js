"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const T=5,b=t=>t.reduce((c,s)=>c+parseFloat(s.state),0)/t.length,i=t=>parseFloat(t[t.length-1].state)||0,_=(t,c,s,u,r,g)=>{const n=[];let l=(g-r)/80;l=l!==0?l:80;let e=s/(c-(u===1?1:0));e=isFinite(e)?e:s;const o=t.filter(Boolean)[0];let f=[b(o),i(o)];const d=(a,N,v=0,m=1)=>{if(m>1&&a)return a.forEach((S,R)=>d(S,N,R,m-1));const h=e*(N+v/6);a&&(f=[b(a),i(a)]);const x=80+T/2-((a?f[0]:f[1])-r)/l;return n.push([h,x])};for(let a=0;a<t.length;a+=1)d(t[a],a,0,u);return n.length===1&&(n[1]=[s,n[0][1]]),n.push([s,n[n.length-1][1]]),n},M=(t,c,s,u,r)=>{t.forEach(e=>{e.state=Number(e.state)}),t.every(e=>Number.isNaN(e.state))&&(t=t.map((e,o)=>Number.isNaN(e.state)?{...e,state:o}:e)),t=t.filter(e=>!Number.isNaN(e.state));const g=r?.min!==void 0?r.min:Math.min(...t.map(e=>e.state)),n=r?.max!==void 0?r.max:Math.max(...t.map(e=>e.state)),p=new Date().getTime(),l=(e,o,f)=>{const d=p-new Date(o.last_changed).getTime();let a=Math.abs(d/(1e3*3600)-c);return f?(a=(a-Math.floor(a))*60,a=Number((Math.round(a/10)*10).toString()[0])):a=Math.floor(a),e[a]||(e[a]=[]),e[a].push(o),e};if(t=t.reduce((e,o)=>l(e,o,!1),[]),u>1&&(t=t.map(e=>e.reduce((o,f)=>l(o,f,!0),[]))),!!t.length)return _(t,c,s,u,g,n)},C=(t,c,s,u,r)=>{if(!t)return;const g=t.map(n=>({_state:n.s,state:Number(n.s),last_changed:n.lu*1e3}));return M(g,c,s,u,r)};exports.coordinates=M;exports.coordinatesMinimalResponseCompressedState=C;
//# sourceMappingURL=coordinates.js.map
