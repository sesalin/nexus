{"version":3,"file":"index.js","sources":["../../../../src/hooks/useFloors/index.ts"],"sourcesContent":["import { useAreas, useHass, type Area } from \"@core\";\nimport { useMemo } from \"react\";\nimport type { FloorRegistryEntry } from \"@utils/subscribe/floors\";\n\nexport interface FloorWithAreas extends FloorRegistryEntry {\n  /** Discriminator so consumers can detect synthetic unassigned bucket */\n  type: \"floor\" | \"unassigned\";\n  /** Areas belonging to this floor (enriched area objects) */\n  areas: Area[];\n}\n\n/**\n * Hook returning an ordered list of floors, each enriched with its areas, plus a\n * synthetic trailing \"Unassigned\" entry (type = \"unassigned\") when areas exist\n * without an assigned floor.\n */\nexport function useFloors(): FloorWithAreas[] {\n  const allAreas = useAreas();\n  const floorsRecord = useHass((state) => state.floors);\n\n  return useMemo(() => {\n    const floorAreaLookup = getFloorAreaLookup(allAreas);\n    const unassignedAreas = allAreas.filter((area) => !area.floor_id || !floorAreaLookup[area.floor_id]);\n\n    const floors: FloorWithAreas[] = Object.values(floorsRecord).map((floor) => ({\n      ...floor,\n      type: \"floor\",\n      areas: floorAreaLookup[floor.floor_id] || [],\n    }));\n\n    if (unassignedAreas.length) {\n      floors.push({\n        floor_id: \"unassigned\",\n        name: \"Unassigned\",\n        level: null,\n        icon: null,\n        aliases: [] as string[],\n        created_at: Date.now(),\n        modified_at: Date.now(),\n        type: \"unassigned\",\n        areas: unassignedAreas,\n      });\n    }\n\n    return floors;\n  }, [allAreas, floorsRecord]);\n}\n\ntype FloorAreaLookup = Record<string, Area[]>;\n\nconst getFloorAreaLookup = (areas: Area[]): FloorAreaLookup => {\n  const floorAreaLookup: FloorAreaLookup = {};\n  for (const area of areas) {\n    if (!area.floor_id) {\n      continue;\n    }\n    if (!(area.floor_id in floorAreaLookup)) {\n      floorAreaLookup[area.floor_id] = [];\n    }\n    floorAreaLookup[area.floor_id].push(area);\n  }\n  return floorAreaLookup;\n};\n"],"names":["useFloors","allAreas","useAreas","floorsRecord","useHass","state","useMemo","floorAreaLookup","getFloorAreaLookup","unassignedAreas","area","floors","floor","areas"],"mappings":"6WAgBO,SAASA,GAA8B,CAC5C,MAAMC,EAAWC,EAAAA,SAAA,EACXC,EAAeC,EAAAA,QAASC,GAAUA,EAAM,MAAM,EAEpD,OAAOC,EAAAA,QAAQ,IAAM,CACnB,MAAMC,EAAkBC,EAAmBP,CAAQ,EAC7CQ,EAAkBR,EAAS,OAAQS,GAAS,CAACA,EAAK,UAAY,CAACH,EAAgBG,EAAK,QAAQ,CAAC,EAE7FC,EAA2B,OAAO,OAAOR,CAAY,EAAE,IAAKS,IAAW,CAC3E,GAAGA,EACH,KAAM,QACN,MAAOL,EAAgBK,EAAM,QAAQ,GAAK,CAAA,CAAC,EAC3C,EAEF,OAAIH,EAAgB,QAClBE,EAAO,KAAK,CACV,SAAU,aACV,KAAM,aACN,MAAO,KACP,KAAM,KACN,QAAS,CAAA,EACT,WAAY,KAAK,IAAA,EACjB,YAAa,KAAK,IAAA,EAClB,KAAM,aACN,MAAOF,CAAA,CACR,EAGIE,CACT,EAAG,CAACV,EAAUE,CAAY,CAAC,CAC7B,CAIA,MAAMK,EAAsBK,GAAmC,CAC7D,MAAMN,EAAmC,CAAA,EACzC,UAAWG,KAAQG,EACZH,EAAK,WAGJA,EAAK,YAAYH,IACrBA,EAAgBG,EAAK,QAAQ,EAAI,CAAA,GAEnCH,EAAgBG,EAAK,QAAQ,EAAE,KAAKA,CAAI,GAE1C,OAAOH,CACT"}