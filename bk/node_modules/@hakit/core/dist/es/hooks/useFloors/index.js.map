{"version":3,"file":"index.js","sources":["../../../../src/hooks/useFloors/index.ts"],"sourcesContent":["import { useAreas, useHass, type Area } from \"@core\";\nimport { useMemo } from \"react\";\nimport type { FloorRegistryEntry } from \"@utils/subscribe/floors\";\n\nexport interface FloorWithAreas extends FloorRegistryEntry {\n  /** Discriminator so consumers can detect synthetic unassigned bucket */\n  type: \"floor\" | \"unassigned\";\n  /** Areas belonging to this floor (enriched area objects) */\n  areas: Area[];\n}\n\n/**\n * Hook returning an ordered list of floors, each enriched with its areas, plus a\n * synthetic trailing \"Unassigned\" entry (type = \"unassigned\") when areas exist\n * without an assigned floor.\n */\nexport function useFloors(): FloorWithAreas[] {\n  const allAreas = useAreas();\n  const floorsRecord = useHass((state) => state.floors);\n\n  return useMemo(() => {\n    const floorAreaLookup = getFloorAreaLookup(allAreas);\n    const unassignedAreas = allAreas.filter((area) => !area.floor_id || !floorAreaLookup[area.floor_id]);\n\n    const floors: FloorWithAreas[] = Object.values(floorsRecord).map((floor) => ({\n      ...floor,\n      type: \"floor\",\n      areas: floorAreaLookup[floor.floor_id] || [],\n    }));\n\n    if (unassignedAreas.length) {\n      floors.push({\n        floor_id: \"unassigned\",\n        name: \"Unassigned\",\n        level: null,\n        icon: null,\n        aliases: [] as string[],\n        created_at: Date.now(),\n        modified_at: Date.now(),\n        type: \"unassigned\",\n        areas: unassignedAreas,\n      });\n    }\n\n    return floors;\n  }, [allAreas, floorsRecord]);\n}\n\ntype FloorAreaLookup = Record<string, Area[]>;\n\nconst getFloorAreaLookup = (areas: Area[]): FloorAreaLookup => {\n  const floorAreaLookup: FloorAreaLookup = {};\n  for (const area of areas) {\n    if (!area.floor_id) {\n      continue;\n    }\n    if (!(area.floor_id in floorAreaLookup)) {\n      floorAreaLookup[area.floor_id] = [];\n    }\n    floorAreaLookup[area.floor_id].push(area);\n  }\n  return floorAreaLookup;\n};\n"],"names":["useFloors","allAreas","useAreas","floorsRecord","useHass","state","useMemo","floorAreaLookup","getFloorAreaLookup","unassignedAreas","area","floors","floor","areas"],"mappings":";;;;;;;;;AAgBO,SAASA,IAA8B;AAC5C,QAAMC,IAAWC,EAAA,GACXC,IAAeC,EAAQ,CAACC,MAAUA,EAAM,MAAM;AAEpD,SAAOC,EAAQ,MAAM;AACnB,UAAMC,IAAkBC,EAAmBP,CAAQ,GAC7CQ,IAAkBR,EAAS,OAAO,CAACS,MAAS,CAACA,EAAK,YAAY,CAACH,EAAgBG,EAAK,QAAQ,CAAC,GAE7FC,IAA2B,OAAO,OAAOR,CAAY,EAAE,IAAI,CAACS,OAAW;AAAA,MAC3E,GAAGA;AAAA,MACH,MAAM;AAAA,MACN,OAAOL,EAAgBK,EAAM,QAAQ,KAAK,CAAA;AAAA,IAAC,EAC3C;AAEF,WAAIH,EAAgB,UAClBE,EAAO,KAAK;AAAA,MACV,UAAU;AAAA,MACV,MAAM;AAAA,MACN,OAAO;AAAA,MACP,MAAM;AAAA,MACN,SAAS,CAAA;AAAA,MACT,YAAY,KAAK,IAAA;AAAA,MACjB,aAAa,KAAK,IAAA;AAAA,MAClB,MAAM;AAAA,MACN,OAAOF;AAAA,IAAA,CACR,GAGIE;AAAA,EACT,GAAG,CAACV,GAAUE,CAAY,CAAC;AAC7B;AAIA,MAAMK,IAAqB,CAACK,MAAmC;AAC7D,QAAMN,IAAmC,CAAA;AACzC,aAAWG,KAAQG;AACjB,IAAKH,EAAK,aAGJA,EAAK,YAAYH,MACrBA,EAAgBG,EAAK,QAAQ,IAAI,CAAA,IAEnCH,EAAgBG,EAAK,QAAQ,EAAE,KAAKA,CAAI;AAE1C,SAAOH;AACT;"}