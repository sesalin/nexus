{"version":3,"file":"index.js","sources":["../../../../src/hooks/useLightColor/index.ts"],"sourcesContent":["import { useMemo } from \"react\";\nimport { HassEntityWithService, ON, lightSupportsColorMode, getLightCurrentModeRgbColor, rgb2hs, LIGHT_COLOR_MODES } from \"@core\";\n\nexport type UseLightColorReturn = {\n  /** The adjusted brightness color, adjusted to a percentage scale, this will change based on the entity state/attribute values */\n  brightnessAdjusted: number | undefined;\n  /** The white color component of the light. */\n  white: number | undefined;\n  /** The cool white color component of the light. */\n  coolWhite: number | undefined;\n  /** The warm white color component of the light. */\n  warmWhite: number | undefined;\n  /** The brightness of the light's color component. */\n  colorBrightness: number | undefined;\n  /** The hue and saturation values of the light's color component. */\n  hs: [number, number] | undefined;\n};\n\nexport const useLightColor = (entity: HassEntityWithService<\"light\">): UseLightColorReturn => {\n  const brightnessAdjusted = useMemo<number | undefined>(() => {\n    if (entity.state === ON) {\n      if (\n        entity.attributes.color_mode === LIGHT_COLOR_MODES.RGB &&\n        entity.attributes.rgb_color &&\n        !lightSupportsColorMode(entity, LIGHT_COLOR_MODES.RGBWW) &&\n        !lightSupportsColorMode(entity, LIGHT_COLOR_MODES.RGBW)\n      ) {\n        const maxVal = Math.max(...entity.attributes.rgb_color);\n\n        if (maxVal < 255) {\n          return maxVal;\n        }\n      }\n      return undefined;\n    }\n    return undefined;\n  }, [entity]);\n\n  const white = useMemo(() => {\n    const value =\n      entity.state !== ON\n        ? undefined\n        : entity.attributes.color_mode === LIGHT_COLOR_MODES.RGBW && entity.attributes.rgbw_color\n          ? Math.round((entity.attributes.rgbw_color[3] * 100) / 255)\n          : undefined;\n    return value != null ? (value * 255) / 100 : undefined;\n  }, [entity]);\n  const coolWhite = useMemo(() => {\n    const value =\n      entity.state !== ON\n        ? undefined\n        : entity.attributes.color_mode === LIGHT_COLOR_MODES.RGBWW && entity.attributes.rgbww_color\n          ? Math.round((entity.attributes.rgbww_color[3] * 100) / 255)\n          : undefined;\n    return value != null ? (value * 255) / 100 : undefined;\n  }, [entity]);\n  const warmWhite = useMemo(() => {\n    const value =\n      entity.state !== ON\n        ? undefined\n        : entity.attributes.color_mode === LIGHT_COLOR_MODES.RGBWW && entity.attributes.rgbww_color\n          ? Math.round((entity.attributes.rgbww_color[4] * 100) / 255)\n          : undefined;\n    return value != null ? (value * 255) / 100 : undefined;\n  }, [entity]);\n  const currentRgbColor = getLightCurrentModeRgbColor(entity);\n  const colorBrightness = useMemo(() => {\n    const value =\n      entity.state !== ON ? undefined : currentRgbColor ? Math.round((Math.max(...currentRgbColor.slice(0, 3)) * 100) / 255) : undefined;\n    return value != null ? (value * 255) / 100 : undefined;\n  }, [entity, currentRgbColor]);\n  const hs = useMemo(() => {\n    return entity.state !== ON ? undefined : currentRgbColor ? rgb2hs(currentRgbColor.slice(0, 3) as [number, number, number]) : undefined;\n  }, [entity, currentRgbColor]);\n\n  return {\n    brightnessAdjusted,\n    white,\n    coolWhite,\n    warmWhite,\n    colorBrightness,\n    hs,\n  };\n};\n"],"names":["useLightColor","entity","brightnessAdjusted","useMemo","ON","LIGHT_COLOR_MODES","lightSupportsColorMode","maxVal","white","value","coolWhite","warmWhite","currentRgbColor","getLightCurrentModeRgbColor","colorBrightness","hs","rgb2hs"],"mappings":";;;;;;;;;;;AAkBO,MAAMA,IAAgB,CAACC,MAAgE;AAC5F,QAAMC,IAAqBC,EAA4B,MAAM;AAC3D,QAAIF,EAAO,UAAUG,GAAI;AACvB,UACEH,EAAO,WAAW,eAAeI,EAAkB,OACnDJ,EAAO,WAAW,aAClB,CAACK,EAAuBL,GAAQI,EAAkB,KAAK,KACvD,CAACC,EAAuBL,GAAQI,EAAkB,IAAI,GACtD;AACA,cAAME,IAAS,KAAK,IAAI,GAAGN,EAAO,WAAW,SAAS;AAEtD,YAAIM,IAAS;AACX,iBAAOA;AAAA,MAEX;AACA;AAAA,IACF;AAAA,EAEF,GAAG,CAACN,CAAM,CAAC,GAELO,IAAQL,EAAQ,MAAM;AAC1B,UAAMM,IACJR,EAAO,UAAUG,IACb,SACAH,EAAO,WAAW,eAAeI,EAAkB,QAAQJ,EAAO,WAAW,aAC3E,KAAK,MAAOA,EAAO,WAAW,WAAW,CAAC,IAAI,MAAO,GAAG,IACxD;AACR,WAAOQ,KAAS,OAAQA,IAAQ,MAAO,MAAM;AAAA,EAC/C,GAAG,CAACR,CAAM,CAAC,GACLS,IAAYP,EAAQ,MAAM;AAC9B,UAAMM,IACJR,EAAO,UAAUG,IACb,SACAH,EAAO,WAAW,eAAeI,EAAkB,SAASJ,EAAO,WAAW,cAC5E,KAAK,MAAOA,EAAO,WAAW,YAAY,CAAC,IAAI,MAAO,GAAG,IACzD;AACR,WAAOQ,KAAS,OAAQA,IAAQ,MAAO,MAAM;AAAA,EAC/C,GAAG,CAACR,CAAM,CAAC,GACLU,IAAYR,EAAQ,MAAM;AAC9B,UAAMM,IACJR,EAAO,UAAUG,IACb,SACAH,EAAO,WAAW,eAAeI,EAAkB,SAASJ,EAAO,WAAW,cAC5E,KAAK,MAAOA,EAAO,WAAW,YAAY,CAAC,IAAI,MAAO,GAAG,IACzD;AACR,WAAOQ,KAAS,OAAQA,IAAQ,MAAO,MAAM;AAAA,EAC/C,GAAG,CAACR,CAAM,CAAC,GACLW,IAAkBC,EAA4BZ,CAAM,GACpDa,IAAkBX,EAAQ,MAAM;AACpC,UAAMM,IACJR,EAAO,UAAUG,IAAK,SAAYQ,IAAkB,KAAK,MAAO,KAAK,IAAI,GAAGA,EAAgB,MAAM,GAAG,CAAC,CAAC,IAAI,MAAO,GAAG,IAAI;AAC3H,WAAOH,KAAS,OAAQA,IAAQ,MAAO,MAAM;AAAA,EAC/C,GAAG,CAACR,GAAQW,CAAe,CAAC,GACtBG,IAAKZ,EAAQ,MACVF,EAAO,UAAUG,IAAK,SAAYQ,IAAkBI,EAAOJ,EAAgB,MAAM,GAAG,CAAC,CAA6B,IAAI,QAC5H,CAACX,GAAQW,CAAe,CAAC;AAE5B,SAAO;AAAA,IACL,oBAAAV;AAAA,IACA,OAAAM;AAAA,IACA,WAAAE;AAAA,IACA,WAAAC;AAAA,IACA,iBAAAG;AAAA,IACA,IAAAC;AAAA,EAAA;AAEJ;"}