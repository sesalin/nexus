import { useState as p, useRef as E, useCallback as g, useEffect as W, useMemo as w } from "react";
import "lodash";
import { W as y } from "../../../index-1tDtVGr2.js";
import "../useLocale/locales/index.js";
import "home-assistant-js-websocket";
import { u as F } from "../../../index-BiRhtKmJ.js";
import "@iconify/react";
import { useDebouncedCallback as _ } from "use-debounce";
import { subscribeForecast as k, getForecast as C } from "./helpers.js";
import "../../utils/date.js";
function B(n, v) {
  const i = y((r) => r.connection), c = F(n), [a, d] = p(null), [f, h] = p(null), e = E(!1), t = E(void 0), { type: b = "daily" } = v || {}, m = g(
    (r, o) => k(i, r, o, (s) => {
      e.current && h(s);
    }).catch((s) => {
      e.current = !1, s instanceof Error && d(s.message);
    }),
    [i]
  ), l = _(
    async (r, o) => {
      if (t.current) {
        const u = await t.current;
        u && u(), t.current = void 0;
      }
      e.current = !0, t.current = await m(r, o);
    },
    100,
    {
      trailing: !0,
      leading: !0
    }
  );
  if (W(() => (l(n, b), () => {
    e.current = !1, t.current && t.current();
  }), [b, l, m, n]), a)
    throw a;
  return w(() => {
    const r = C(c.attributes, f);
    return {
      ...c,
      forecast: r
    };
  }, [c, f]);
}
export {
  B as useWeather
};
//# sourceMappingURL=index.js.map
