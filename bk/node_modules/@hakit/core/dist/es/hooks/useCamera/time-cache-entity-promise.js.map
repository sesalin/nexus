{"version":3,"file":"time-cache-entity-promise.js","sources":["../../../../src/hooks/useCamera/time-cache-entity-promise.ts"],"sourcesContent":["import { Connection } from \"home-assistant-js-websocket\";\n\ninterface ResultCache<T> {\n  [entityId: string]: { timestamp: number; promise: Promise<T> } | undefined;\n}\n\nconst cache: ResultCache<unknown> = {}; // Replace 'unknown' with your data type if known\n\n/**\n * Call a function with result caching per entity.\n * @param cacheKey key to store the cache on hass object\n * @param cacheTime time to cache the results\n * @param func function to fetch the data\n * @param connection Home Assistant connection object\n * @param entityId entity to fetch data for\n * @param args extra arguments to pass to the function to fetch the data\n * @returns\n */\nexport const timeCacheEntityPromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (connection: Connection, entityId: string, ...args: unknown[]) => Promise<T>,\n  connection: Connection,\n  entityId: string,\n  ...args: unknown[]\n): Promise<T> => {\n  const currentTime = Date.now();\n  const _cacheKey = `${cacheKey}-${entityId}`;\n\n  // Check if the result is in the cache and still valid\n  const cacheEntry = cache[_cacheKey];\n  if (cacheEntry && currentTime - cacheEntry.timestamp < cacheTime) {\n    return cacheEntry.promise as Promise<T>;\n  }\n\n  // Otherwise, fetch the result and update the cache\n  const resultPromise = func(connection, entityId, ...args);\n  cache[_cacheKey] = { timestamp: currentTime, promise: resultPromise };\n\n  return resultPromise;\n};\n"],"names":["cache","timeCacheEntityPromiseFunc","cacheKey","cacheTime","func","connection","entityId","args","currentTime","_cacheKey","cacheEntry","resultPromise"],"mappings":"AAMA,MAAMA,IAA8B,CAAA,GAYvBC,IAA6B,OACxCC,GACAC,GACAC,GACAC,GACAC,MACGC,MACY;AACf,QAAMC,IAAc,KAAK,IAAA,GACnBC,IAAY,GAAGP,CAAQ,IAAII,CAAQ,IAGnCI,IAAaV,EAAMS,CAAS;AAClC,MAAIC,KAAcF,IAAcE,EAAW,YAAYP;AACrD,WAAOO,EAAW;AAIpB,QAAMC,IAAgBP,EAAKC,GAAYC,GAAU,GAAGC,CAAI;AACxD,SAAAP,EAAMS,CAAS,IAAI,EAAE,WAAWD,GAAa,SAASG,EAAA,GAE/CA;AACT;"}