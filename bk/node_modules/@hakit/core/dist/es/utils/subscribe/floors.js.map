{"version":3,"file":"floors.js","sources":["../../../../src/utils/subscribe/floors.ts"],"sourcesContent":["import { RegistryEntry } from \"@utils/entity_registry\";\nimport { Connection, createCollection } from \"home-assistant-js-websocket\";\nimport { Store } from \"home-assistant-js-websocket/dist/store.js\";\nimport { debounce } from \"lodash\";\n\nexport interface FloorRegistryEntry extends RegistryEntry {\n  floor_id: string;\n  name: string;\n  level: number | null;\n  icon: string | null;\n  aliases: string[];\n}\n\nconst fetchFloorRegistry = (conn: Connection) =>\n  conn.sendMessagePromise<FloorRegistryEntry[]>({\n    type: \"config/floor_registry/list\",\n  });\n\nconst subscribeFloorRegistryUpdates = (conn: Connection, store: Store<FloorRegistryEntry[]>) =>\n  conn.subscribeEvents(\n    debounce(() => fetchFloorRegistry(conn).then((areas: FloorRegistryEntry[]) => store.setState(areas, true)), 500, {\n      leading: true,\n      trailing: true,\n    }),\n    \"floor_registry_updated\",\n  );\n\nexport const subscribeFloorRegistry = (conn: Connection, onChange: (floors: FloorRegistryEntry[]) => void) =>\n  createCollection<FloorRegistryEntry[]>(\"_floorRegistry\", fetchFloorRegistry, subscribeFloorRegistryUpdates, conn, onChange);\n"],"names":["fetchFloorRegistry","conn","subscribeFloorRegistryUpdates","store","debounce","areas","subscribeFloorRegistry","onChange","createCollection"],"mappings":";;AAaA,MAAMA,IAAqB,CAACC,MAC1BA,EAAK,mBAAyC;AAAA,EAC5C,MAAM;AACR,CAAC,GAEGC,IAAgC,CAACD,GAAkBE,MACvDF,EAAK;AAAA,EACHG,EAAS,MAAMJ,EAAmBC,CAAI,EAAE,KAAK,CAACI,MAAgCF,EAAM,SAASE,GAAO,EAAI,CAAC,GAAG,KAAK;AAAA,IAC/G,SAAS;AAAA,IACT,UAAU;AAAA,EAAA,CACX;AAAA,EACD;AACF,GAEWC,IAAyB,CAACL,GAAkBM,MACvDC,EAAuC,kBAAkBR,GAAoBE,GAA+BD,GAAMM,CAAQ;"}