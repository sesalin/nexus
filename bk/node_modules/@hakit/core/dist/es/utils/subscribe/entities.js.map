{"version":3,"file":"entities.js","sources":["../../../../src/utils/subscribe/entities.ts"],"sourcesContent":["import { Connection, createCollection } from \"home-assistant-js-websocket\";\nimport { Store } from \"home-assistant-js-websocket/dist/store.js\";\nimport { debounce } from \"lodash\";\nimport { EntityRegistryEntry } from \"@utils/entity_registry\";\n\nconst fetchEntityRegistry = (conn: Connection) =>\n  conn.sendMessagePromise<EntityRegistryEntry[]>({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeEntityRegistryUpdates = (conn: Connection, store: Store<EntityRegistryEntry[]>) =>\n  conn.subscribeEvents(\n    debounce(() => fetchEntityRegistry(conn).then((entities) => store.setState(entities, true)), 500, {\n      leading: true,\n      trailing: true,\n    }),\n    \"entity_registry_updated\",\n  );\n\nexport const subscribeEntityRegistry = (conn: Connection, onChange: (entities: EntityRegistryEntry[]) => void) =>\n  createCollection<EntityRegistryEntry[]>(\"_entityRegistry\", fetchEntityRegistry, subscribeEntityRegistryUpdates, conn, onChange);\n"],"names":["fetchEntityRegistry","conn","subscribeEntityRegistryUpdates","store","debounce","entities","subscribeEntityRegistry","onChange","createCollection"],"mappings":";;AAKA,MAAMA,IAAsB,CAACC,MAC3BA,EAAK,mBAA0C;AAAA,EAC7C,MAAM;AACR,CAAC,GAEGC,IAAiC,CAACD,GAAkBE,MACxDF,EAAK;AAAA,EACHG,EAAS,MAAMJ,EAAoBC,CAAI,EAAE,KAAK,CAACI,MAAaF,EAAM,SAASE,GAAU,EAAI,CAAC,GAAG,KAAK;AAAA,IAChG,SAAS;AAAA,IACT,UAAU;AAAA,EAAA,CACX;AAAA,EACD;AACF,GAEWC,IAA0B,CAACL,GAAkBM,MACxDC,EAAwC,mBAAmBR,GAAqBE,GAAgCD,GAAMM,CAAQ;"}